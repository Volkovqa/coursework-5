# Курсовая работа № 5. Выгрузка вакансий в базу данных.
Данная программа запрашивает вакансии с сайта hh.ru через API, выгружает в базу данных таблицы с вакансиями и работодателями.

## Технологии
- [Python](https://www.python.org/)
- [PostgreSQL](https://www.postgresql.org/)
- Poetry

## Установка и использование
Библиотеки и зависимости можно найти в файле pyproject.toml
В файле dbmanager/queries.sql даны команды для предварительной работы с базой данных - необходимо создать ДБ и две таблицы в ней.
Заполнение таблиц и очистка при штатном выходе из программы происходит автоматически.

## Разработка

### Утилиты
Утилиты находятся в файле utils.py - это два метода, отвечающие за добавление в таблицы информации о работодателях и вакансиях.

### Настройка работы с API hh.ru
Класс для работы с API сервиса находится в файле hhapi/hhapiengine.py. Класс имеет методы для получения данных о работодателях и вакансиях.
Опционально при создании экземпляра класса можно казать параметр page (по умолчанию 0), чтобы попасть на нужную страницу поиска.
Конфигурация для работы находится в файле hhapi/hh_api_config.py
В конфигурации прописываются поля:
- employers_ids - коды работодателей, чьи вакансии пользователь хочет выгрузить;
- vacancies_per_page - количество вакансий на странице для выгрузки;
- area - географическая область поиска;
- only_with_salary - флаг, фильтрующий вакансии без указания заработной платы.
Если нужно поменять конфигурацию поиска, стоит обращаться к [документации по API hh.ru](https://api.hh.ru/openapi/redoc)

### Настройка работы с базой данных
Класс для работы с базой данных находится в файле dbmanager/db_manager.
Класс имеет методы для выгрузки данных из заполненных таблиц:
- работодатели и количество открытых вакансий (работодатель, кол-во вакансий)
- информация о всех вакансиях в БД (название вакансии, работодатель, средняя зарплата, url-ссылка)
  средняя зарплата высчитывается как среднее между минимальной и максимальной (если какая-то граница не указана, она берется как 0)
- средняя зарплата по всем вакансиям в БД
- получение вакансий с зарплатой выше средней по базе
- поиск вакансий в базе по ключевому слову



